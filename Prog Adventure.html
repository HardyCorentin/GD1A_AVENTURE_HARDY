<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" /><title>Adventure</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js"></script>
    <style type="text/css"> body { margin: 0; }</style>
</head>


<body>
    <script type="text/javascript">

            
class Titlescreen extends Phaser.Scene {
                    constructor() {
                        super('Titlescreen');
                    }

                    preload(){
                        this.load.image('TitleScreen', 'assets/Titlescreen.png');

                    }

                    create(){
                        
                        this.add.image(640, 360, 'TitleScreen');
                        

                      this.cursors = this.input.keyboard.createCursorKeys();

                    }

                    update(){

                        if (this.cursors.space.isDown){
                            this.scene.start("room1");
                        }

                    }
                }

            class room1 extends Phaser.Scene {
                constructor() {
                    super("room1");
                }
                preload() {
                    this.load.image("tiles","assets/ground and walls.png");
                    this.load.tilemapTiledJSON('room1', 'LD/room1.json');
                    this.load.image("lifebar","assets/lifebar.png");

                    
                    this.load.spritesheet('hero','assets/hero.png',
                    { frameWidth: 32, frameHeight: 32 });
                }
                create(){
                    const levelmap = this.add.tilemap("room1");
                    const tileset = levelmap.addTilesetImage(
                        "ground and walls",
                        "tiles"
                    );

                   

                    this.cursors = this.input.keyboard.createCursorKeys();
                    
                    const ground  = levelmap.createLayer(
                        "ground",
                        tileset
                    ); 
                    
                    const walls = levelmap.createLayer(
                        "walls",
                        tileset                    
                    );
                    const obstacles  = levelmap.createLayer(
                        "obstacles",
                        tileset                    
                    );
                    const doors  = levelmap.createLayer(
                        "doors",
                        tileset
                    ); 
                     
                    
                    this.player = this.physics.add.sprite(100, 450, 'hero',0);
                    
                    this.add.image(50,100,"lifebar");
                    
                    
                    
                    
              
                    
                    //Animations
                    
                    this.anims.create({
                    key: 'left',
                    frames: this.anims.generateFrameNumbers('hero', {start:14,end:17}),
                    frameRate: 10,
                    repeat: -1
                    });
                    this.anims.create({
                        key: 'turn',
                        frames: this.anims.generateFrameNumbers('hero', {start:0,end:3}),
                        frameRate: 10,
                        repeat: -1
                    });
                    this.anims.create({
                        key: 'right',
                        frames: this.anims.generateFrameNumbers('hero', {start:4,end:7}),
                        frameRate: 10,
                        repeat: -1
                    });
                    this.anims.create({
                        key: 'down',
                        frames: this.anims.generateFrameNumbers('hero', {start:9,end:12}),
                        frameRate: 10,
                        repeat: -1
                    });
                    this.anims.create({
                        key: 'up',
                        frames: this.anims.generateFrameNumbers('hero', {start:19,end:22}),
                        frameRate: 10,
                        repeat: -1
                    });
                    this.anims.create({
                        key: 'dashup',
                        frames: this.anims.generateFrameNumbers('hero', {start:23,end:23}),
                        frameRate: 10,
                        repeat: -1
                    });
                    this.anims.create({
                        key: 'dashright',
                        frames: this.anims.generateFrameNumbers('hero', {start:8,end:8}),
                        frameRate: 10,
                        repeat: -1
                    });
                    this.anims.create({
                        key: 'dashleft',
                        frames: this.anims.generateFrameNumbers('hero', {start:18,end:18}),
                        frameRate: 10,
                        repeat: -1
                    });
                    this.anims.create({
                        key: 'dashdown',
                        frames: this.anims.generateFrameNumbers('hero', {start:13,end:13}),
                        frameRate: 10,
                        repeat: -1
                    });
                //Fin Animations
                    this.cameras.main.zoom = 3
                        this.cameras.main.startFollow(this.player); 
                        this.physics.world.setBounds(0, 0, 3000, 5000);
                        this.cameras.main.setBounds(0, 0, 3000, 5000);
                }
                update(){
                    
                    
                    
                    
                
                    this.player.body.velocity.set(0);
                
                
                
                
                
                    //Déplacements
                    if (this.cursors.left.isDown){ //si la touche gauche est appuyée
                        this.player.setVelocityX(-160); //alors vitesse négative en X
                        this.player.anims.play('left', true); //et animation => gauche
                    }
                    
                    
                    
                    if (this.cursors.left.shiftKey){
                    //si touche gauche appuyée et shift aussi
                        this.player.setVelocityX(-450);
                        this.player.anims.play('dashleft', true); 
                    }
                    
                    
                    
                    else if (this.cursors.right.isDown){ //sinon si la touche droite est appuyée
                        this.player.setVelocityX(160); //alors vitesse positive en X
                        this.player.anims.play('right', true); //et animation => droite
                    }
                    
                    
                    
                    else if (this.cursors.right.shiftKey){
                    //si touche droite appuyée et shift aussi
                        this.player.setVelocityX(450);
                        this.player.anims.play('dashright', true); 
                    }
                    
                    
                    
                    if (this.cursors.up.isDown){
                    //si touche haut appuyée
                        this.player.setVelocityY(-160);
                        this.player.anims.play('up', true); //alors vitesse verticale négative
                    //(on saute)
                    }
                    
                    
                    
                    else if (this.cursors.up.shiftKey){
                    //si touche haut appuyée et shift aussi
                        this.player.setVelocityY(-450);
                        this.player.anims.play('dashup', true); 
                    }
                    
                    
                    if (this.cursors.down.isDown){
                    //si touche bas appuyée
                        this.player.setVelocityY(160);
                        this.player.anims.play('down', true); //alors vitesse verticale négative
                    
                    }
                    
                    
                    else if (this.cursors.down.shiftKey){
                        //si touche bas appuyée et shift aussi
                        this.player.setVelocityY(450);
                        this.player.anims.play('dashdown', true);
                    }
                    
                    
                    
                    

            }
            
            
        }
            var config = {
            type: Phaser.AUTO,
            width: 1280, height: 720,
            physics: {
            default: 'arcade',
            arcade: {
            debug: false
            }},
            scene : [Titlescreen,room1]
            
            };
            new Phaser.Game(config);
            


                
            
        

                

                
                
            //}
    </script>
</body>
</html>